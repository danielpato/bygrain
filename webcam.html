<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>byGRAIN Cam</title>
  <style>
    body {
      background: #c0c0c0;
      font-family: 'Tahoma', 'MS Sans Serif', sans-serif;
      margin: 0;
      padding: 40px 20px;
      text-align: center;
    }

    h1 {
      font-size: 20px;
      margin-bottom: 20px;
    }

    video {
      transform: scaleX(-1);
      border: 2px solid #000;
      height: 300px;
      width: auto;
      margin-bottom: 20px;
    }

    canvas {
      display: none; /* Used only for capturing */
    }

    button {
      font-family: inherit;
      font-size: 14px;
      padding: 6px 18px;
      background: #d4d0c8;
      border: 2px solid #fff;
      border-right-color: #404040;
      border-bottom-color: #404040;
      box-shadow: inset -1px -1px #808080, inset 1px 1px #fff;
      cursor: pointer;
      margin: 0 5px 20px 5px;
    }

    button:active {
      border: 2px solid #404040;
      border-top-color: #fff;
      border-left-color: #fff;
      box-shadow: inset 1px 1px #808080, inset -1px -1px #fff;
    }

    #capturedImage {
      border: 2px solid #000;
      height: 300px;
      width: auto;
      display: block;
      margin: 20px auto 0 auto;
    }
  </style>
</head>
<body>
  <video id="video" autoplay playsinline></video><br>
  <button id="captureBtn">üì∏ Take Photo</button>
  <button id="timerBtn">‚è± 3 sec timer</button>
  <canvas id="canvas"></canvas>
  <img id="capturedImage" style="display:none;">

  <script>
    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const captureBtn = document.getElementById("captureBtn");
    const timerBtn = document.getElementById("timerBtn");
    const capturedImage = document.getElementById("capturedImage");

    // Start the webcam
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream)
      .catch(err => alert("Webcam error: " + err));

    // Regular "Take Photo" button
    captureBtn.addEventListener("click", takePhoto);

    // Timer Button Logic
    timerBtn.addEventListener("click", () => {
      let countdown = 3;
      const originalText = timerBtn.textContent;

      timerBtn.disabled = true;
      timerBtn.textContent = countdown;

      const interval = setInterval(() => {
        countdown--;
        if (countdown > 0) {
          timerBtn.textContent = countdown;
        } else {
          clearInterval(interval);
          timerBtn.textContent = "Snap";
          takePhoto();

          setTimeout(() => {
            timerBtn.textContent = originalText;
            timerBtn.disabled = false;
          }, 1000);
        }
      }, 1000);
    });

    // Photo Capture Logic
    function takePhoto() {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const ctx = canvas.getContext("2d");

      // Mirror effect
      ctx.translate(canvas.width, 0);
      ctx.scale(-1, 1);
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
5
      const imageData = canvas.toDataURL("image/png");

      capturedImage.src = imageData;
      capturedImage.style.display = 'block';

      // Auto-download
      const link = document.createElement("a");
      link.href = imageData;
      link.download = `photobooth_${Date.now()}.png`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
</body>
</html>
